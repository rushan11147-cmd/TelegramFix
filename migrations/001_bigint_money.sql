-- Миграция: Изменение типа данных для предотвращения переполнения
-- Дата: 2026-01-28
-- Описание: Меняем INTEGER на BIGINT для больших чисел

-- Примечание: В PostgreSQL JSON поля не имеют типа на уровне БД
-- Но мы добавим проверку в приложении

-- Добавляем индекс для ускорения запросов
CREATE INDEX IF NOT EXISTS idx_users_user_id ON users(user_id);

-- Добавляем уникальный индекс для предотвращения дублирования целей
-- (будет реализовано в приложении через проверку)

-- Комментарий для будущих разработчиков
COMMENT ON TABLE users IS 'Таблица пользователей игры. JSON поле data содержит все игровые данные.';
COMMENT ON COLUMN users.user_id IS 'Уникальный ID пользователя из Telegram';
COMMENT ON COLUMN users.data IS 'JSON с игровыми данными: money (до 9223372036854775807), energy, items и т.д.';
COMMENT ON COLUMN users.last_updated IS 'Время последнего обновления данных пользователя';
