# Исправление ошибки выбора профессии

## Проблема
При выборе профессии (Курьер, Офисный работник и т.д.) появлялась ошибка "Internal server error".

## Причины
1. **Несоответствие типов данных**: `user_id` в приложении - строка (string), но `CareerManager` ожидал целое число (integer)
2. **Несовместимость с PostgreSQL**: Код использовал SQLite-специфичный синтаксис `INSERT OR REPLACE`, который не работает в PostgreSQL
3. **Отсутствие параметра базы данных**: `CareerManager` не знал, какую базу данных использовать (PostgreSQL или SQLite)

## Исправления

### 1. career_system.py
- Изменен тип `player_id` с `int` на `str` во всех методах
- Добавлена поддержка PostgreSQL с правильным синтаксисом (`ON CONFLICT ... DO UPDATE`)
- Добавлен параметр `use_postgres` в конструктор `CareerManager`
- Все SQL-запросы теперь используют правильные плейсхолдеры (`%s` для PostgreSQL, `?` для SQLite)
- Изменен тип поля `player_id` в таблице с `INTEGER` на `TEXT`

### 2. app.py
- Обновлена инициализация `CareerManager` с передачей параметра `use_postgres`

## Результат
✅ Теперь выбор профессии работает корректно
✅ Поддерживаются обе базы данных (PostgreSQL и SQLite)
✅ Нет конфликтов типов данных

## Тестирование
1. Запустите сервер: `python app.py`
2. Откройте игру в браузере
3. Выберите любую профессию
4. Проверьте, что ошибка больше не появляется

## Дата исправления
31 января 2026
