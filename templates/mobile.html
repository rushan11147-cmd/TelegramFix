<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–í—ã–∂–∏–≤–∏ –¥–æ –∑–∞—Ä–ø–ª–∞—Ç—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: url('/static/game-background.jpg.jpg') center center / cover no-repeat fixed;
            color: #2c3e50;
            min-height: 100vh;
            padding: 0;
            margin: 0;
            overflow-x: hidden;
        }
        
        .container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }
        
        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å - —Å–∏–Ω—è—è —Å –∑–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–º–∏ —É–≥–ª–∞–º–∏ */
        .top-bar {
            background: linear-gradient(135deg, #2c5f8d 0%, #1e4266 100%);
            border-radius: 20px;
            padding: 12px 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .top-bar-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .top-bar-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }
        
        /* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å */
        .main-area {
            flex: 1;
            display: flex;
            gap: 15px;
            align-items: stretch;
        }
        
        /* –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å–ª–µ–≤–∞ */
        .character-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* –ü–∞–Ω–µ–ª—å —Å–ø—Ä–∞–≤–∞ —Å –±–µ–∂–µ–≤–æ–π —Ä–∞–º–∫–æ–π */
        .game-panel {
            width: 380px;
            background: linear-gradient(135deg, #f5f0e8 0%, #e8dcc0 100%);
            border-radius: 25px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            border: 6px solid #d4c4a0;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ */
        .stat-bar {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            border-radius: 15px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        .stat-bar.mood {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        }
        
        .stat-bar.health {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .stat-bar-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-bar-icon {
            font-size: 20px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .action-btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 15px;
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        
        .action-btn:active {
            transform: scale(0.98);
        }
        
        /* –ö–æ—Ä–∏—á–Ω–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ "–†–∞–±–æ—Ç–∞" */
        .action-btn.work {
            background: linear-gradient(135deg, #8b4513 0%, #654321 100%);
        }
        
        /* –û—Ä–∞–Ω–∂–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∏" */
        .action-btn.sidejob {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }
        
        /* –°–∏–Ω—è—è –∫–Ω–æ–ø–∫–∞ "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è" */
        .action-btn.entertainment {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        /* –ó–µ–ª—ë–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ü–æ—Ä–∞–±–æ—Ç–∞—Ç—å" */
        .action-btn.do-work {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        /* –ö—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ó–∞–∫–æ–Ω—á–∏—Ç—å –¥–µ–Ω—å" */
        .action-btn.end-day {
            background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
        }
        
        .job-info-card {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 12px;
            padding: 12px;
            border: 2px solid rgba(139, 69, 19, 0.2);
        }
        
        @media (max-width: 768px) {
            .main-area {
                flex-direction: column;
            }
            
            .character-area {
                display: none;
            }
            
            .game-panel {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –í–µ—Ä—Ö–Ω—è—è —Å–∏–Ω—è—è –ø–∞–Ω–µ–ª—å -->
        <div class="top-bar">
            <div class="top-bar-left">
                <span>–ú–µ—Å—è—Ü <span id="month">1</span> | –î–µ–Ω—å <span id="day">1</span> / 30</span>
            </div>
            <div class="top-bar-right">
                <span>üí∞ <span id="topMoney">282</span>‚ÇΩ</span>
                <button class="top-bar-btn" onclick="showLeaderboard()"><i class="fas fa-trophy"></i></button>
                <button class="top-bar-btn" onclick="showStats()"><i class="fas fa-list"></i></button>
            </div>
        </div>
        
        <div class="main-area">
            <!-- –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å–ª–µ–≤–∞ (–Ω–∞ —Ñ–æ–Ω–µ) -->
            <div class="character-area">
                <!-- –ü–µ—Ä—Å–æ–Ω–∞–∂ –≤–∏–¥–µ–Ω –Ω–∞ —Ñ–æ–Ω–µ -->
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å —Å–ø—Ä–∞–≤–∞ -->
            <div class="game-panel">
                <!-- –î–µ–Ω—å–≥–∏ -->
                <div class="stat-bar">
                    <div class="stat-bar-left">
                        <span class="stat-bar-icon">üí∞</span>
                        <span id="money">282</span> ‚ÇΩ
                    </div>
                    <div>
                        <span id="energyDisplay">100/100</span> +
                    </div>
                </div>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ -->
                <div class="stat-bar mood">
                    <div class="stat-bar-left">
                        <span class="stat-bar-icon" id="moodEmoji">üòä</span>
                        <span id="moodValue">50</span>
                    </div>
                    <div id="moodText">–ù–æ—Ä–º–∞–ª—å–Ω–æ</div>
                </div>
                
                <!-- –ó–¥–æ—Ä–æ–≤—å–µ -->
                <div class="stat-bar health">
                    <div class="stat-bar-left">
                        <span class="stat-bar-icon">‚ù§Ô∏è</span>
                        <span id="healthValue">100</span>
                    </div>
                    <div id="healthText">–ó–¥–æ—Ä–æ–≤</div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ 1x3 -->
                <div class="action-buttons" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                    <button class="action-btn work" style="padding: 12px 8px; font-size: 13px;" onclick="showJobs()">
                        <i class="fas fa-briefcase"></i> –†–∞–±–æ—Ç–∞
                    </button>
                    <button class="action-btn" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); padding: 12px 8px; font-size: 13px;" onclick="showShop()">
                        <i class="fas fa-shopping-cart"></i> –ú–∞–≥–∞–∑–∏–Ω
                    </button>
                    <button class="action-btn" style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); padding: 12px 8px; font-size: 13px;" onclick="showGoals()">
                        <i class="fas fa-trophy"></i> –¶–µ–ª–∏
                    </button>
                </div>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ -->
                <div class="job-info-card">
                    <div style="font-weight: bold; margin-bottom: 5px;">–¢–≤–æ—è —Ä–∞–±–æ—Ç–∞: <span id="currentJobName">–ö—É—Ä—å–µ—Ä</span></div>
                    <div style="font-size: 13px; color: #666;">
                        üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞: +<span id="jobIncome">80</span>‚ÇΩ | ‚ö° –≠–Ω–µ—Ä–≥–∏—è: -<span id="jobEnergy">5</span>
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="action-buttons">
                    <button class="action-btn work" onclick="showJobs()">
                        <i class="fas fa-briefcase"></i> –†–∞–±–æ—Ç–∞
                    </button>
                    
                    <button class="action-btn sidejob" onclick="showSideJobs()">
                        <i class="fas fa-clock"></i> –ü–æ–¥—Ä–∞–±–æ—Ç–∫–∏
                    </button>
                    
                    <button class="action-btn entertainment" onclick="showEntertainment()">
                        <i class="fas fa-gamepad"></i> –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è
                        <span style="font-size: 12px;">-50‚ÇΩ –≠–Ω–µ—Ä–≥–∏—è: +20</span>
                    </button>
                    
                    <button class="action-btn do-work" id="workBtn" onclick="work()">
                        <i class="fas fa-briefcase"></i> –ü–æ—Ä–∞–±–æ—Ç–∞—Ç—å
                    </button>
                    
                    <button class="action-btn end-day" id="nextDayBtn" onclick="confirmEndDay()">
                        <i class="fas fa-moon"></i> –ó–∞–∫–æ–Ω—á–∏—Ç—å –¥–µ–Ω—å –∏ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // –í–µ—Å—å JavaScript –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ –∫–∞–∫ –≤ simple.html
        let userId = localStorage.getItem('userId');
        if (!userId) {
            userId = 'web_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('userId', userId);
        }
        
        let gameData = {};
        
        async function loadUserData() {
            try {
                const response = await fetch('/api/user/' + userId);
                if (response.ok) {
                    gameData = await response.json();
                    updateUI();
                }
            } catch (error) {
                console.error('Load error:', error);
            }
        }
        
        function updateUI() {
            document.getElementById('day').textContent = gameData.day || 1;
            document.getElementById('month').textContent = gameData.month || 1;
            document.getElementById('money').textContent = gameData.money || 282;
            document.getElementById('topMoney').textContent = gameData.money || 282;
            
            const currentEnergy = gameData.energy || 100;
            const maxEnergy = gameData.max_energy || 100;
            document.getElementById('energyDisplay').textContent = currentEnergy + '/' + maxEnergy;
            
            const mood = gameData.mood || 50;
            document.getElementById('moodValue').textContent = mood;
            
            let moodEmoji = 'üòê';
            let moodText = '–ù–æ—Ä–º–∞–ª—å–Ω–æ';
            if (mood <= 20) {
                moodEmoji = 'üò≠';
                moodText = '–î–µ–ø—Ä–µ—Å—Å–∏—è';
            } else if (mood <= 40) {
                moodEmoji = 'üòî';
                moodText = '–ì—Ä—É—Å—Ç–Ω–æ';
            } else if (mood <= 60) {
                moodEmoji = 'üòê';
                moodText = '–ù–æ—Ä–º–∞–ª—å–Ω–æ';
            } else if (mood <= 80) {
                moodEmoji = 'üôÇ';
                moodText = '–•–æ—Ä–æ—à–æ';
            } else {
                moodEmoji = 'üòÑ';
                moodText = '–û—Ç–ª–∏—á–Ω–æ';
            }
            document.getElementById('moodEmoji').textContent = moodEmoji;
            document.getElementById('moodText').textContent = moodText;
            
            const health = gameData.health || 100;
            document.getElementById('healthValue').textContent = health;
            
            let healthText = '–ó–¥–æ—Ä–æ–≤';
            if (health <= 20) {
                healthText = '–ö—Ä–∏—Ç–∏—á–Ω–æ';
            } else if (health <= 40) {
                healthText = '–ü–ª–æ—Ö–æ';
            } else if (health <= 60) {
                healthText = '–£—Å—Ç–∞–ª';
            } else if (health <= 80) {
                healthText = '–ù–æ—Ä–º–∞–ª—å–Ω–æ';
            }
            document.getElementById('healthText').textContent = healthText;
            
            const jobs = {
                'delivery': { name: '–î–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã', income: 80, energy: 5 },
                'office': { name: '–û—Ñ–∏—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞', income: 120, energy: 3 },
                'freelance': { name: '–§—Ä–∏–ª–∞–Ω—Å', income: 200, energy: 7 },
                'crypto': { name: '–ö—Ä–∏–ø—Ç–æ-—Ç—Ä–µ–π–¥–∏–Ω–≥', income: 300, energy: 10 }
            };
            
            const currentJobId = gameData.current_job || 'delivery';
            const currentJob = jobs[currentJobId];
            if (currentJob) {
                document.getElementById('currentJobName').textContent = currentJob.name;
                document.getElementById('jobIncome').textContent = currentJob.income;
                document.getElementById('jobEnergy').textContent = currentJob.energy;
            }
        }
        
        async function work() {
            try {
                const response = await fetch('/api/work', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    gameData = result.user;
                    updateUI();
                    alert('+' + result.income + '‚ÇΩ');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }
        
        async function confirmEndDay() {
            if (confirm('–ó–∞–∫–æ–Ω—á–∏—Ç—å –¥–µ–Ω—å?')) {
                try {
                    const response = await fetch('/api/next_day', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ user_id: userId })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        gameData = result.user;
                        updateUI();
                        alert('–ù–æ–≤—ã–π –¥–µ–Ω—å!');
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            }
        }
        
        function showJobs() {
            alert('–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é —Ä–∞–±–æ—Ç—ã');
        }
        
        function showShop() {
            alert('–û—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω');
        }
        
        function showGoals() {
            alert('–û—Ç–∫—Ä—ã—Ç—å —Ü–µ–ª–∏');
        }
        
        function showSideJobs() {
            alert('–û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏');
        }
        
        function showEntertainment() {
            alert('–û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è');
        }
        
        function showLeaderboard() {
            alert('–û—Ç–∫—Ä—ã—Ç—å —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤');
        }
        
        function showStats() {
            alert('–û—Ç–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É');
        }
        
        loadUserData();
    </script>
</body>
</html>