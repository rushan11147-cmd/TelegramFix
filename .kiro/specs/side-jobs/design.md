# –î–∏–∑–∞–π–Ω: –°–∏—Å—Ç–µ–º–∞ –ø–æ–±–æ—á–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```python
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏
SIDE_JOB = {
    'id': str,              # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
    'name': str,            # –ù–∞–∑–≤–∞–Ω–∏–µ
    'description': str,     # –û–ø–∏—Å–∞–Ω–∏–µ
    'category': str,        # –ö–∞—Ç–µ–≥–æ—Ä–∏—è: physical, mental, creative, social
    'base_payment': int,    # –ë–∞–∑–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞
    'energy_cost': int,     # –ó–∞—Ç—Ä–∞—Ç—ã —ç–Ω–µ—Ä–≥–∏–∏
    'success_rate': float,  # –ë–∞–∑–æ–≤—ã–π —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞ (0.0-1.0)
    'emoji': str           # –ò–∫–æ–Ω–∫–∞
}

# –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_data = {
    'available_side_jobs': [str],  # ID –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
    'completed_side_jobs_today': [str],  # ID –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è
    'side_jobs_stats': {
        'total_completed': int,
        'total_earned': int,
        'success_count': int,
        'fail_count': int
    }
}
```

### 1.2 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **SideJobManager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞–º–∏
2. **SideJobGenerator** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
3. **SideJobExecutor** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
4. **SideJobRepository** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## 2. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 2.1 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫

```python
def generate_daily_side_jobs(user_id):
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3-5 —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
    count = random.randint(3, 5)
    
    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏ –∏–∑ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
    available = random.sample(ALL_SIDE_JOBS, count)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_data['available_side_jobs'] = [job['id'] for job in available]
    user_data['completed_side_jobs_today'] = []
    
    return available
```

### 2.2 –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏

```python
def execute_side_job(user_id, job_id):
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
    if job_id not in user_data['available_side_jobs']:
        return {'error': '–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞'}
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
    if job_id in user_data['completed_side_jobs_today']:
        return {'error': '–£–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞'}
    
    # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–Ω–µ—Ä–≥–∏—é
    job = get_job_by_id(job_id)
    if user_data['energy'] < job['energy_cost']:
        return {'error': '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏'}
    
    # 4. –°–ø–∏—Å—ã–≤–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é
    user_data['energy'] -= job['energy_cost']
    
    # 5. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞ —Å —É—á–µ—Ç–æ–º –Ω–∞–≤—ã–∫–æ–≤
    success_rate = calculate_success_rate(job, user_data)
    
    # 6. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    success = random.random() < success_rate
    
    if success:
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–ø–ª–∞—Ç—É —Å —É—á–µ—Ç–æ–º –Ω–∞–≤—ã–∫–æ–≤
        payment = calculate_payment(job, user_data)
        user_data['money'] += payment
        user_data['side_jobs_stats']['success_count'] += 1
        user_data['side_jobs_stats']['total_earned'] += payment
        
        result = {
            'success': True,
            'payment': payment,
            'message': f'–£—Å–ø–µ—Ö! –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ {payment}‚ÇΩ'
        }
    else:
        user_data['side_jobs_stats']['fail_count'] += 1
        result = {
            'success': False,
            'payment': 0,
            'message': '–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å... –≠–Ω–µ—Ä–≥–∏—è –ø–æ—Ç—Ä–∞—á–µ–Ω–∞'
        }
    
    # 7. –û—Ç–º–µ—á–∞–µ–º –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é
    user_data['completed_side_jobs_today'].append(job_id)
    user_data['side_jobs_stats']['total_completed'] += 1
    
    return result
```

### 2.3 –†–∞—Å—á–µ—Ç —à–∞–Ω—Å–∞ —É—Å–ø–µ—Ö–∞

```python
def calculate_success_rate(job, user_data):
    base_rate = job['success_rate']
    
    # –ë–æ–Ω—É—Å –æ—Ç –Ω–∞–≤—ã–∫–∞ "–£–¥–∞—á–∞"
    luck_bonus = (user_data['skills']['luck'] - 1) * 0.05  # +5% –∑–∞ —É—Ä–æ–≤–µ–Ω—å
    
    # –ò—Ç–æ–≥–æ–≤—ã–π —à–∞–Ω—Å (–º–∞–∫—Å–∏–º—É–º 95%)
    final_rate = min(0.95, base_rate + luck_bonus)
    
    return final_rate
```

### 2.4 –†–∞—Å—á–µ—Ç –æ–ø–ª–∞—Ç—ã

```python
def calculate_payment(job, user_data):
    base_payment = job['base_payment']
    multiplier = 1.0
    
    # –ë–æ–Ω—É—Å –æ—Ç –Ω–∞–≤—ã–∫–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    if job['category'] == 'social':
        # –•–∞—Ä–∏–∑–º–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–ø–ª–∞—Ç—É —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
        multiplier += (user_data['skills']['charisma'] - 1) * 0.05
    
    elif job['category'] == 'mental':
        # –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–ø–ª–∞—Ç—É —É–º—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
        multiplier += (user_data['skills']['intelligence'] - 1) * 0.05
    
    # –ò—Ç–æ–≥–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞
    final_payment = int(base_payment * multiplier)
    
    return final_payment
```

## 3. API Endpoints

### 3.1 GET /api/side-jobs/list
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `user_id` (required)

**–û—Ç–≤–µ—Ç:**
```json
{
    "available_jobs": [
        {
            "id": "loader",
            "name": "–ì—Ä—É–∑—á–∏–∫",
            "description": "–†–∞–∑–≥—Ä—É–∑–∫–∞ —Ñ—É—Ä—ã",
            "category": "physical",
            "payment": 300,
            "energy_cost": 15,
            "success_rate": 0.8,
            "emoji": "üì¶",
            "completed": false
        }
    ]
}
```

### 3.2 POST /api/side-jobs/execute
–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–¥—Ä–∞–±–æ—Ç–∫—É

**Body:**
```json
{
    "user_id": "user123",
    "job_id": "loader"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "success": true,
    "payment": 300,
    "message": "–£—Å–ø–µ—Ö! –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 300‚ÇΩ",
    "user": { /* –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */ }
}
```

### 3.3 GET /api/side-jobs/stats
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `user_id` (required)

**–û—Ç–≤–µ—Ç:**
```json
{
    "total_completed": 45,
    "total_earned": 18500,
    "success_count": 38,
    "fail_count": 7,
    "success_rate": 0.844
}
```

## 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–≥—Ä–æ–π

### 4.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –Ω–æ–≤—ã–π –¥–µ–Ω—å
```python
def next_day():
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ ...
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏
    generate_daily_side_jobs(user_id)
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ...
```

### 4.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞–≤—ã–∫–∞–º–∏
- –ù–∞–≤—ã–∫ "–£–¥–∞—á–∞" ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞
- –ù–∞–≤—ã–∫ "–•–∞—Ä–∏–∑–º–∞" ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–ø–ª–∞—Ç—É —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
- –ù–∞–≤—ã–∫ "–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç" ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–ø–ª–∞—Ç—É —É–º—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫
- –ù–∞–≤—ã–∫ "–°–∫–æ—Ä–æ—Å—Ç—å" ‚Üí —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã —ç–Ω–µ—Ä–≥–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## 5. UI/UX

### 5.1 –ö–Ω–æ–ø–∫–∞ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∏" üíº —Ä—è–¥–æ–º —Å "–†–∞–±–æ—Ç–∞"
- –¶–≤–µ—Ç: –æ—Ä–∞–Ω–∂–µ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫

### 5.2 –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∏"
- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ä–∞–±–æ—Ç–æ–∫ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
- –ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - –ò–∫–æ–Ω–∫—É –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
  - –û–ø–∏—Å–∞–Ω–∏–µ
  - –û–ø–ª–∞—Ç—É –∏ –∑–∞—Ç—Ä–∞—Ç—ã —ç–Ω–µ—Ä–≥–∏–∏
  - –®–∞–Ω—Å —É—Å–ø–µ—Ö–∞
  - –ö–Ω–æ–ø–∫—É "–í—ã–ø–æ–ª–Ω–∏—Ç—å" –∏–ª–∏ –º–µ—Ç–∫—É "–í—ã–ø–æ–ª–Ω–µ–Ω–æ"

### 5.3 –ê–Ω–∏–º–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- –ü—Ä–∏ —É—Å–ø–µ—Ö–µ: –∑–µ–ª–µ–Ω–∞—è –≤—Å–ø—ã—à–∫–∞ + "+300‚ÇΩ"
- –ü—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ: –∫—Ä–∞—Å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞ + "–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å"

## 6. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

### 6.1 –≠–∫–æ–Ω–æ–º–∏–∫–∞
- –°—Ä–µ–¥–Ω—è—è –æ–ø–ª–∞—Ç–∞ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏: 400‚ÇΩ
- –°—Ä–µ–¥–Ω—è—è –æ–ø–ª–∞—Ç–∞ –∑–∞ —ç–Ω–µ—Ä–≥–∏—é: 35‚ÇΩ/—ç–Ω–µ—Ä–≥–∏—è
- –ü–æ–¥—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–≥–æ–¥–Ω–µ–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –Ω–æ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–µ–µ

### 6.2 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è
- –ù–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏: –ø—Ä–æ—Å—Ç—ã–µ, –Ω–∏–∑–∫–∏–π —Ä–∏—Å–∫
- –ü–æ–∑–¥–Ω–∏–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏: —Å–ª–æ–∂–Ω—ã–µ, –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫, –≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä–∞–¥–∞
- –ù–∞–≤—ã–∫–∏ –¥–µ–ª–∞—é—Ç –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–≥–æ–¥–Ω–µ–µ

## 7. Correctness Properties

### P1: –≠–Ω–µ—Ä–≥–∏—è –≤—Å–µ–≥–¥–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
**–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** ‚àÄ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏ ‚Üí —ç–Ω–µ—Ä–≥–∏—è —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ energy_cost

### P2: –û–ø–ª–∞—Ç–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
**–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –¥–µ–Ω—å–≥–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è ‚ü∫ success = true

### P3: –ü–æ–¥—Ä–∞–±–æ—Ç–∫—É –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –¥–µ–Ω—å
**–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** job_id ‚àà completed_today ‚Üí –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ

### P4: –®–∞–Ω—Å —É—Å–ø–µ—Ö–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 0.95]
**–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** 0 ‚â§ calculated_success_rate ‚â§ 0.95

### P5: –°–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
**–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** day_changed ‚Üí available_jobs = generate_new()
